(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{eXzn:function(w,E,e){"use strict";e.r(E);var k=e("IzEo"),I=e("bx4M"),t=e("nKUr"),K=e("o0o1"),s=e.n(K),P=e("HaE+"),B=e("9kvl"),O=e("tMyG"),n=e("q1tI"),l=e.n(n),V=e("Telt"),L=e("Tckk"),N=e("1OyB"),J=e("vuIU"),F=e("Ji7U"),x=e("LK+K"),q=e("ye1Q"),_=e("xvlK");function ee(i,a){var r=new FileReader;r.addEventListener("load",function(){return a(r.result)}),r.readAsDataURL(i)}var te=function(i){Object(F.a)(r,i);var a=Object(x.a)(r);function r(){var c;Object(N.a)(this,r);for(var o=arguments.length,g=new Array(o),u=0;u<o;u++)g[u]=arguments[u];return c=a.call.apply(a,[this].concat(g)),c.state={loading:!1},c.handleChange=function(v){if(v.file.status==="uploading"){c.setState({loading:!0});return}v.file.status==="done"&&ee(v.file.originFileObj,function(j){return c.setState({imageUrl:j,loading:!1})})},c}return Object(J.a)(r,[{key:"render",value:function(){var o=this.state,g=o.loading,u=o.imageUrl,v=Object(t.jsxs)("div",{children:[g?Object(t.jsx)(q.a,{}):Object(t.jsx)(_.a,{}),Object(t.jsx)("div",{style:{marginTop:8},children:"Upload"})]});return Object(t.jsx)(L.a,{size:240,src:this.props.avatarUrl})}}]),r}(l.a.Component),Oe=te,me=e("fOrg"),R=e("+KLJ"),m=e("VTBJ"),je=e("+L6B"),W=e("2/Rp"),fe=e("y8nQ"),b=e("Vl3Y"),ge=e("5NDa"),X=e("5rEg"),he=e("14J3"),ae=e("BMrR"),Ue=e("tU7J"),re=e("wFql"),A=e("ODXe"),$=e("k9Yu"),se=e("vX7Z"),z={labelCol:{span:8},wrapperCol:{span:16}},G={wrapperCol:{offset:8,span:16}},ne=function(a){var r=a.user,c=a.loading,o=r.currentUser,g=Object(n.useState)(!1),u=Object(A.a)(g,2),v=u[0],j=u[1],C=Object(n.useState)(null),S=Object(A.a)(C,2),d=S[0],f=S[1],ie=Object(n.useState)(!1),Q=Object(A.a)(ie,2),ce=Q[0],Y=Q[1],oe=Object(n.useState)(null),Z=Object(A.a)(oe,2),y=Z[0],H=Z[1],ue=function(){var D=Object(P.a)(s.a.mark(function h(U){return s.a.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:j(!0),Object($.g)(U).then(function(){f({success:"OTP successfully sent to email"})}).catch(function(p){f({error:"Failed to send OTP to email"})}),j(!1);case 3:case"end":return T.stop()}},h)}));return function(U){return D.apply(this,arguments)}}(),ve=function(){var D=Object(P.a)(s.a.mark(function h(U){var M;return s.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(Y(!0),Object($.h)(U).then(function(){H({success:"Email Verified"})}).catch(function(Se){H({error:"Invalid OTP entered"})}),M=a.dispatch,!M){p.next=6;break}return p.next=6,M({type:"user/fetchCurrent"});case 6:Y(!1);case 7:case"end":return p.stop()}},h)}));return function(U){return D.apply(this,arguments)}}(),de=function(){return o.roles.map(function(h,U){return Object(t.jsx)(se.b,{style:{marginLeft:"1em"},role:h.name},U)})};return Object(t.jsxs)("div",{children:[Object(t.jsxs)(ae.a,{style:{marginBottom:"1em"},children:[Object(t.jsx)(re.a.Title,{level:5,style:{marginRight:"1em"},children:"Access level"}),de()]}),Object(t.jsxs)(b.a,Object(m.a)(Object(m.a)({},z),{},{name:"basic",initialValues:{nus_email:o.nus_email},onFinish:ue,children:[Object(t.jsx)(b.a.Item,{label:"Nus Email",name:"nus_email",children:Object(t.jsx)(X.a,{})}),Object(t.jsx)(b.a.Item,Object(m.a)(Object(m.a)({},G),{},{children:Object(t.jsx)(W.a,{type:"primary",htmlType:"submit",loading:v,children:"Send OTP to email"})}))]})),d&&d.success&&Object(t.jsx)(R.a,{message:d.success,type:"success"}),d&&d.error&&Object(t.jsx)(R.a,{message:d.error,type:"error"}),d&&d.success&&Object(t.jsxs)(b.a,Object(m.a)(Object(m.a)({style:{marginTop:"1em"}},z),{},{name:"basic",onFinish:ve,children:[Object(t.jsx)(b.a.Item,{label:"OTP",name:"otp",children:Object(t.jsx)(X.a,{})}),Object(t.jsx)(b.a.Item,Object(m.a)(Object(m.a)({},G),{},{children:Object(t.jsx)(W.a,{type:"primary",htmlType:"submit",loading:ce||c,children:"Submit"})})),y&&y.success&&Object(t.jsx)(R.a,{message:y.success,type:"success"}),y&&y.error&&Object(t.jsx)(R.a,{message:y.error,type:"error"})]}))]})},Ee=Object(B.b)(function(i){var a=i.user,r=i.loading;return{user:a,loading:r.models.user}})(ne),le=function(a){console.log("profile props",a);var r=a.user,c=a.loading,o=r.currentUser,g=function(){var v=Object(P.a)(s.a.mark(function j(C){var S;return s.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(S=a.dispatch,!S){f.next=4;break}return f.next=4,S({type:"user/updateCurrent",user:C});case 4:case"end":return f.stop()}},j)}));return function(C){return v.apply(this,arguments)}}(),u=function(j){};return Object(t.jsx)(O.a,{children:Object(t.jsx)(I.a,{children:foo})})},be=E.default=Object(B.b)(function(i){var a=i.user,r=i.loading;return{user:a,loading:r.models.user}})(le)},vX7Z:function(w,E,e){"use strict";e.d(E,"a",function(){return l}),e.d(E,"c",function(){return L}),e.d(E,"b",function(){return N});var k=e("+BJd"),I=e("mr32"),t=e("nKUr"),K=e.n(t),s=e("rePB"),P=e("q1tI"),B=e.n(P),O,n,l={PUBLIC_USER:"PUBLIC_USER",NUS_USER:"NUS_USER",MOD_USER:"MOD_USER",ADMIN:"ADMIN"},V=(O={},Object(s.a)(O,l.PUBLIC_USER,"green"),Object(s.a)(O,l.NUS_USER,"purple"),Object(s.a)(O,l.MOD_USER,"orange"),Object(s.a)(O,l.ADMIN,"magenta"),O),L=(n={},Object(s.a)(n,l.PUBLIC_USER,"Public User"),Object(s.a)(n,l.NUS_USER,"NUS User"),Object(s.a)(n,l.MOD_USER,"Module User"),Object(s.a)(n,l.ADMIN,"Admin"),n),N=function(F){var x=F.role;return Object(t.jsx)(I.a,{color:V[x],children:L[x]})}}}]);
